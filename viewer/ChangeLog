2001-06-30  Jens Finke <jens@gnome.org>

	* eog-image.c: Call gdk_pixbuf_loader_close before
	gdk_pixbuf_loader_get_pixbuf. Otherwise we fail to open xpm and tiff
	images, due to some hacks in gdk-pixbuf.

2001-06-29  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* eog-full-screen.[c,h]: New file (resurrected from eog/src).
	* Makefile.am: Add above files.
	* eog-image-view-ui.xml: Separate menus and commands. Add entry for 
	full screen.
	* eog-image-view.c: Callback for full screen. Formatting.

2001-06-27  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	Ok, I got it. eog-image-viewer now exits when unused [1]. It basically
	boils down to adding stuff with bonobo_object_add_interface only when
	ref_count == 1 _and_ not touching it afterwards
	(i.e. _not_ bonobo_object_unref). God knows why...

	[1] Using "moniker-test -c file:/path/to/file". When using eog, the 
	eog-image-viewer will still be alive after exiting eog. This has yet
	to be investigated.

	* eog-control.c: Small changes (see above).
	* eog-image-view.c Small changes (see above).

2001-06-27  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* eog-control.c: Don't keep references to the widget (displayed by the
	control) and the image - we simply don't need them. Unref the 
	image-view on destroy - we created it during construction. 

2001-06-27  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* main.c: Kill 50% of all lines by using BONOBO_OAF_FACTORY_MULTI.
	* eog-image.c: Initialize gnome-vfs here (if needed).

2001-06-27  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* eog-image-view.c: In an attempt to clean up in order to be able
	to find the ref-leaks, remove the (unused) BonoboItemContainer.

2001-06-27  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* Makefile.am: Compile sample-container again (noinst)
	* sample-container.c: Rewrite to properly clean up behind. The
	eog-image-viewer is still alive after sample-container is done, 
	therefore the ref-leaks seem to be in the eog-image-viewer and not
	in the shell.

2001-06-26  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* .cvsignore: Ignore generated Evolution* files

2001-06-25  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* eog-image-view-ui.xml: Add menu entry "Send" for sending images
	via email
	* eog-image-view.c: (verb_Send_cb): new. Starts a composer and attaches
	the current image.
	(eog_image_view_create_ui): Connect signal to above function.

2001-05-31  Jens Finke <jens@gnome.org>

	* Makefile.am: Stop building the sample-container program.
	(INCLUDES), (eog_image_viewer_LDADD): Added GnomeVFS flags.

	* eog-image-view.c (load_image_from_file): The filename will be
	interpreted as an URI now, using gdk_pixbuf_loader system to load
	the image.

	* main.c (init_server_factory): Added gnome_vfs_init call.
	
2001-05-29  Jens Finke <jens@gnome.org>

	* eog-image-view.c:
	(eog_image_view_get_prop): Set only image filename as window
	title, add handler for 'window/status' property.
	(image_view_zoom_changed_cb): New function, informs listeners to
	'window/status' about changed zoom factor.
	(eog_image_view_construct): Connect to 'zoom_changed' signal, add
	bonobo property 'window/status'.
	
2001-05-29  Jens Finke <jens@gnome.org>

	* eog-image-view.c (eog_image_view_construct): Changed properties
	to 'image/width', 'image/height' and 'window/title'. This is more
	consistent with the rest of the bonobo property naming scheme.

2001-05-28  Jens Finke <jens@gnome.org>

	* eog-print-setup.c (eog_print_setup_new): Added gettext hint for 
        translation. This should fix bug #55349.

2001-05-21  Jens Finke <jens@gnome.org>

	* eog-image-view.c: Renamed bonobo:title property to window_title,
	due to problems with the bonobo_event_make_name function in
	bonobo-listener.c.
 
2001-05-21  Jens Finke <jens@gnome.org>

	* eog-image.c (load_image_from_stream): Try to retrieve the name
	of the stream and set it as filename. We need this to assemble a
	nice bonobo:title. Unfourtunately the bonobo stream implementation
	is broken, so it doesn't work yet.

2001-05-21  Jens Finke <jens@gnome.org>

	* eog-image-view.c: Added three new read-only properties:
	'image_width', 'image_height' and 'bonobo:title'.
	(eog_image_view_get_prop): Added handler for the new properties.
	(eog_image_view_construct): Add new properties to the
	property_bag.

	* eog-image.c (load_image_from_file): Initialize filename in the
	Image-struct.
	
2001-05-18  Jens Finke <jens@gnome.org>

	* eog-image-view.c (image_set_image_cb): Enlarge window to image
	size on loading.

2001-04-14  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview-page.c: Move all cutting helps to top-left when they are 
	no longer shown. Like that, the lines will remain hidden even if the
	orientation or paper size is changed.

2001-04-07  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-image-view.c: Change gdouble to gint in order to get counting
	of pages right.
	* eog-print-setup.c: Fix typo that resulted in the wrong image for
	print order.

2001-04-07  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-image-view.[ch]:
	* eog-preview-page.[ch]:
	* eog-preview.[ch]:
	* eog-print-setup.[ch]:
	* eog-util.[ch]:
	Implement overlap support. Moved the unit selection out of the 
	notebook as it now affects overlap, too.

2001-04-06  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* Makefile.am: Added $(GCONF_LIBS) to sample_container as I put some
	gconf stuff into...
	* eog-util.[ch]: Put some gconf stuff here from...
	* eog-print-setup.[ch]: Give the user the option to cancel everything.
	We now update the preview manually from here instead of doing it 
	through gconf. That makes a move away from gconf easier.
	* eog-image-view.[ch]: Use the functions in eog-util.c to retreive
	the settings.
	* eog-preview-page.c: If cutting help is not wanted, move it to (0,0)
	where we can hide it even if the page size shrinks.
	
2001-04-06  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-image-view.c:
	* eog-preview-page.[ch]:
	* eog-preview.c:
	Don't let the user specify margins that are too big for the page. 
	Store margins as float (we should have done this from the beginning) 
	so that unit conversions won't result in rounding errors. 
	Internally handle everything but pixmap sizes in gdouble. Get preview
	and printing in sync again (not 100% done - but 99,9%...).

2001-04-05  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview-page.c: We don't need SCALE here anywhere.
	* eog-print-setup.c: Implement unit support.

2001-04-04  Lutz Müller  <urc8@rz.uni-karlsruhe.de>
	
	* eog-print-setup.c: First work towards supporting units. Not 
	functional yet, though.

2001-04-03  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-image-view.c: 
	(print_page): Always move (0,0) to bottom left at the beginning. This 
	makes the code cleaner. If needed, ...
	(print_cutting_help): ... print cutting help.

2001-04-02  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview.c: 
	* eog-preview-page.[ch]:
	* eog-image-view.c: Resize the pixbuf once at the beginning. That 
	lets us get rid of the distinction fit_to_page - adjust_to and we
	are able to determine the interpolation type (gnome-print chooses its
	own otherwise).

2001-04-02  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview.c: Give the user the option to print a cutting help.
	* eog-preview-page.c: Show this cutting help if selected.
	* eog-image-view.c: Print a warning that we havent' implemented the 
	printing of the cutting help yet...

2001-04-01  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview-page.c: Show the margins as a red line. Red because
	those lines won't be printed. Shall we give the user the option
	to print them?

2001-03-31  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview-page.[ch]: New files
	* eog-preview.c: This is now a hbox with one or more vboxes containing
	eog-preview-pages. It creates, removes, and updates eog-preview-pages 
	when gconf-settings change. The whole thing is much cleaner now.
	* eog-print-setup: Just show a eog-preview instead of creating hboxes 
	and vboxes.

2001-03-28  Jason Leach  <jasonleach@usa.net>

	* Makefile.am (INCLUDES): builddir != srcdir fix.

2002-03-25  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-preview.[ch]: New files
	* Makefile.am: Added above files and -DICONDIR=..., as we use some 
	icons there
	* eog-image-view.c: Support for printing one image over multiple pages.
	Support for range specification.
	* eog-print-setup.c: Added preview. Support for print order 
	specification. Support for multiple pages. 

2001-03-20  Lutz Müller  <urc8@rz.uni-karlsruhe.de>
	
	* eog-print-setup.[ch]: New files
	* Makefile.am: Add above files and GCONF_LIBS, as we use gconf now
	* eog-image-view-ui.xml: Add menuitem "Print Setup"
	* eog-image-view.h: 
	(eog_image_view_print): New function, was do_print, now used by
	eog-print-setup, too
	* eog-image-view.c: When printing, consider what the user specified 
	via the new print-setup-dialog.

2001-03-18  Lutz Müller  <urc8@rz.uni-karlsruhe.de>

	* eog-image-view-ui.xml: Added menuitems for printing operations.
	* eog-image-view.c:
	(do_print): New function, handles printing operations.
	(verb_PrintPreview_cb),
	(verb_Print_cb): New functions, redirect to above.

2001-03-16  Michael Meeks  <michael@ximian.com>

	* eog-image-view.c (eog_image_view_construct): Use Bilinear as the
	default interpolation type - Hyperbolic is buggy at ~1.0 zoom levels,
	no crashes - just a tartan texture.

2001-03-01  Lutz Müller <urc8@rz.uni-karlsruhe.de>

	* eog-image-view-ui.xml: Added 'FileOperations' placeholder and
	menuitem 'SaveAs'.

	* eog-image-view.c
	(filesel_ok_cb), (filesel_cancel_cb), (verb_SaveAs_cb): New functions.
	(eog_image_view_create_ui): Added callback for 'SaveAs'.

	* eog-image.[ch]
	(save_image_to_stream): Handle type == CORBA_OBJECT_NIL.
	(eog_image_save_to_stream): New function, redirects to function above.

2001-02-27  Jens Finke <jens@gnome.org>

	Applied patch from Lutz Mueller <urc8@rz.uni-karlsruhe.de>:
	
	* eog-control.c (eog_control_create_ui): New path for zoom_menu.

	* eog-image-view-ui.xml: Removed 'Component' placeholder.
	
2001-02-20  Martin Baulig  <baulig@suse.de>

	* preferences.[ch]: New files.

	* eog-image-view.c
	(eog_image_view_get_property_control): New function.
	(eog_image_view_construct): Create the BonoboPropertyControl.
	(eog_image_view_get/set_interpolation/dither/check_type/check_size):
	Get/set values from the PropertyBag and directly from the ImageView
	directly. This way we can "hide" the property bag in the implementation
	and transparently use the get/set function.
	(eog_image_view_get/set_prop): Operate directly on the ImageView.

	* eog-control.c (eog_control_construct): Get the PropertyControl
	from the EogImageView and bonobo_object_add_interface() it.

	* eog-image.[ch]: Use BonoboXObject.
	(eog_image_corba_object_create): Removed.
	(eog_image_construct): Removed `corba_object' argument.

	* eog-image-data.[ch]: Use BonoboXObject.
	(eog_image_data_corba_object_create): Removed.
	(eog_image_data_construct): Removed `corba_object' argument.

	* eog-image-view.[ch]: Use BonoboXObject.
	(eog_image_view_corba_object_create): Removed.
	(eog_image_view_construct): Removed `corba_object' argument.

	* eog-embeddable-view.h (eog_embeddable_view_corba_object_create):
	Removed prototype for non-existing function.

2001-02-15  Jens Finke <jens@gnome.org>

	* eog-control.c (toolbar definition): Changed name to 'Toolbar',
	set correct pixmaps for 'ZoomIn' and 'ZoomOut' items.

	* eog-image-view-ui.xml: Inserted placeholder 'Component', renamed
	submenu from 'EOG' to 'View'.

2001-02-07  Martin Baulig  <baulig@suse.de>

	* Makefile.am (EXTRA_DIST): Added $(ui_DATA).

2001-02-07  Martin Baulig  <baulig@suse.de>

	* eog-embeddable.c
	(eog_embeddable_corba_object_create): Removed.
	(eog_embeddable_construct): Removed Bonobo_Embeddable argument.

2001-02-06  Martin Baulig  <baulig@suse.de>

	* eog-control.c (eog_control_corba_object_create): Removed.
	(eog_control_construct): Removed Bonobo_Control argument.

	* eog-embeddable-view.c
	(eog_embeddable_view_corba_object_create): Removed.
	(eog_embeddable_view_construct): Removed Bonobo_View argument.

2001-01-21  Michael Meeks  <michael@helixcode.com>

	* eog-image.c (eog_image_get_pixbuf): only ref if we have
	a pixbuf.

	* eog-embeddable-view.c (configure_size): unref pixbuf.

	* eog-embeddable.c (render_fn): ditto.

	* main.c (bonobo_object_destroy_cb): remove expliti running
	object counting.
	(init_eog_image_viewer_factory): use a modern unref method.

2001-01-17  Michael Meeks  <michael@helixcode.com>

	* eog-embeddable-view.c (eog_embeddable_view_construct): 
	don't allow scroll bars ever.
	(configure_size): upd.

	* eog-image-view.c (eog_image_view_set_zoom): impl.

2001-01-16  Michael Meeks  <michael@helixcode.com>

	* eog-embeddable-view.c (eog_embeddable_view_construct):
	connect to view_size_allocation. (configure_size): impl.
	(view_size_allocate_cb): hook up.

	* eog-image-view.c (eog_image_view_set_prop),
	(eog_image_view_get_prop): update to new property bag API.

2001-01-17  Michael Meeks  <michael@helixcode.com>

	* eog-image-view.c (eog_image_view_set_prop),
	(eog_image_view_get_prop): update to new property bag API.

2001-01-05  Michael Meeks  <michael@helixcode.com>

	* eog-embeddable.c (render_fn): impl.
	(eog_embeddable_construct): hook up print interface.

2000-12-11  Michael Meeks  <michael@helixcode.com>

	* main.c (bonobo_object_destroy_cb): remove eroneous cast.

2000-12-10  Michael Meeks  <michael@helixcode.com>

	* eog-image-view.c (eog_image_view_construct): add some sensible
	defaults for nicer rendering speed & performance.

2000-12-09  Michael Meeks  <michael@helixcode.com>

	* eog-image.c (eog_image_get_image): only ref if image != NULL.

	* eog-image-view.c (eog_image_view_new),
	(eog_image_view_construct): add control, add image_set_image_cb
	call, so we can actualy see the image if we load data then request
	a view, or create new views later on.

	* eog-embeddable-view.c (eog_embeddable_view_destroy): upd.
	(eog_embeddable_view_construct): upd.

	* eog-embeddable.c (eog_embeddable_construct): update.

	* eog-image-view.c (eog_image_view_set_dither),
	(eog_image_view_get_interpolation),
	(eog_image_view_set_interpolation), 
	(eog_image_view_get_dither),
	(eog_image_view_set_check_type),
	(eog_image_view_get_check_type), 
	(eog_image_view_get_check_size),
	(eog_image_view_set_check_size): kill warnings.
	misc. cleans.

	* eog-control.c (eog_control_construct): drasticaly prune.
	(eog_control_destroy): prune with a hook.

	* eog-image.c (eog_image_add_interfaces): split from
	(eog_image_construct): here.
	(eog_image_destroy): don't double unref item container.

	* main.c (bonobo_object_data_t): expunge
	substantial cleans.

	* eog-image.c (eog_image_construct): use bonobo_object_unref.

	* eog-util.c (eog_util_add_interfaces): remove.

	* GNOME_EOG.oafinfo: update naming convention.

	* main.c (eog_image_viewer_factory): ditto.

2000-12-08  Michael Meeks  <michael@helixcode.com>

	* eog-image-view.c (eog_image_view_destroy): don't unref other
	parts of the aggregate, they are fused with the view.

	* sample-container.c (main): frendlify

2000-12-05  Michael Meeks  <michael@helixcode.com>

	* Makefile.am: install GNOME_EOG.oafinfo instead of
	eog-image-viewer.oafinfo.

2000-11-20  Martin Baulig  <baulig@suse.de>

	* eog-image-io.[ch]: New files. This provides saving code for
	XPM, PNG and JPEG.

	* eog-image.c (save_image_to_stream): New static function; calls
	one of the eog-image-io.c function depending on the content type.

2000-11-20  Martin Baulig  <baulig@suse.de>

	* eog-image-data.[ch]: Removed.

	* eog-image.[ch]: Moved everything from eog-image-data.[ch] here.
	(eog_image_get_image): Formerly known as eog_image_data_get_image().
	(eog_image_get_pixbuf): New function.

2000-11-19  Martin Baulig  <baulig@suse.de>

	* eog-util.[ch]: New files.
	(eog_util_add_interfaces): New function.
	(eog_util_split_string): New function.

	* eog-embeddable.c (eog_embeddable_add_interfaces): Removed, use
	eog_util_add_interfaces() instead.
	* eog-control.c (eog_control_add_interfaces): Likewise.
	* eog-embeddable-view.c (eog_embeddable_view_add_interfaces): Likewise.

	* eog-image.c (eog_image_construct): Create a BonoboItemContainer
	and provide two arguments - `control' which calls eog_control_new()
	on the EogImage to return a new BonoboControl and `embeddable' which
	does the same with eog_embeddable_new().
	
	* eog-image-view.c (eog_image_view_construct): Create a
	BonoboItemContainer.

	* eog-control.c (eog_control_construct): Pass down the
	BonoboItemContainer from the EogImageView.
	* eog-embeddable-view.c (eog_embeddable_view_construct): Likewise.

	* main.c (eog_image_viewer_factory): Added factory for GNOME::EOG::Image.
	(main): Don't force fatal warnings.

	* sample-container.c: New file.

2000-11-19  Martin Baulig  <baulig@suse.de>

	Moved the zoomable from the EogImageView into the EogControl.

	* eog-image-view.h (eog_image_view_get_zoomable): Removed.
	(eog_image_view_get_zoom_factor): New function.
        (eog_image_view_set_zoom_factor): New function.
        (eog_image_view_zoom_to_fit): New function.

	* eog-control.c (eog_control_create_ui): New static function. This
	creates the zoom menus and toolbar.
	(eog_control_set_ui_container): New static function. This calls
	eog_image_view_set_ui_container() and then eog_control_create_ui().
	(eog_control_unset_ui_container): New static function. This calls
	eog_image_view_unset_ui_container().
	(eog_control_activate): Call eog_control_set/unset_ui_container()
	instead of eog_image_view_set/unset_ui_container().
	(eog_control_construct): Create the BonoboZoomable here.

	* eog-image-view.c
	(zoomable_set_frame_cb, zoomable_set_zoom_level_cb,
	zoom_index_from_float, zoom_level_from_index, zoomable_zoom_in_cb,
	zoomable_zoom_out_cb, zoomable_zoom_to_fit_cb,
	zoomable_zoom_to_default_cb, verb_ZoomIn_cb, verb_ZoomOut_cb,
	verb_ZoomToDefault_cb, verb_ZoomToFit_cb): Moved to eog-control.c.

	* eog-control.c:
	(zoomable_set_frame_cb, zoomable_set_zoom_level_cb,
	zoom_index_from_float, zoom_level_from_index, zoomable_zoom_in_cb,
	zoomable_zoom_out_cb, zoomable_zoom_to_fit_cb,
	zoomable_zoom_to_default_cb, verb_ZoomIn_cb, verb_ZoomOut_cb,
	verb_ZoomToDefault_cb, verb_ZoomToFit_cb): Moved here.

2000-11-19  Martin Baulig  <baulig@suse.de>

	* eog-image.[ch]: New files. This implements GNOME::EOG::Image which
	is (currently) derived from GNOME::EOG::ImageData.

	* eog-image-view.c (eog_image_view_new, eog_image_view_construct):
	This now takes a GNOME::EOG::Image, not a GNOME::EOG::ImageData.
	(eog_image_view_get_image_data): Renamed to eog_image_view_get_image().

	* eog-control.c (eog_control_new, eog_control_construct):
	This now takes a GNOME::EOG::Image, not a GNOME::EOG::ImageData.
	* eog-embeddable.c (eog_embeddable_new): Likewise.
	(eog_embeddable_construct): Likewise.
	* eog-embeddable-view.c (eog_embeddable_view_new): Likewise.
	(eog_embeddable_view_construct): Likewise.

2000-11-18  Martin Baulig  <baulig@suse.de>

	* eog-image-view.c (EogImageViewPrivate): Added `has_zoomable_frame'.
	(zoomable_set_frame_cb): New callback function for the "set_frame"
	signal on the Zoomable; this sets image_view->priv->has_zoomable_frame.
	(eog_image_view_create_ui): Manually create the UI for the zoom toolbar
	and the zoom menu entries here, but only if `has_zoomable_frame'.

	* eog-image-view-ui.xml: Removed the EogZoomToolbar and the
	zoom menus.

2000-11-17  Martin Baulig  <baulig@suse.de>

	* eog-image-view.c (verb_ZoomIn_cb, verb_ZoomOut_cb,
	verb_ZoomToDefault_cb, verb_ZoomToFit_cb): New callback functions;
	they emit the corresponding signals on the zoomable.
	(eog_image_viewer_verbs): Added "ZoomIn", "ZoomOut", "ZoomToDefault"
	and "ZoomToFit".

	* eog-image-view-ui.xml: Moved the config stuff into submenus,
	added some menu items for zooming and a "EogZoomToolbar".

2000-11-16  Martin Baulig  <baulig@suse.de>

	* eog-image-view.c (zoomable_zoom_to_fit_cb): Implemented;
	first call ui_image_zoom_fit(), then get the new zoom level
	from the ImageView and emit the "set_zoom_level" signal on
	the zoomable.
	(eog_image_view_construct): Set `has_min_zoom_level' and
	`has_max_zoom_level' on the zoomable.

2000-10-27  Martin Baulig  <baulig@suse.de>

	* eog-image-control.[ch]: Renamed to eog-control.[ch].

	* eog-embeddable.[ch]: New files.
	* eog-embeddable-view.[ch]: New files.

2000-10-26  Martin Baulig  <baulig@suse.de>

	Imported first version of my new eog-image-viewer component.

	* eog-image-data.[ch]: New files.
	* eog-image-view.[ch]: New files.
	* eog-image-control.[ch]: New files.
	* eog-image-view-ui.xml: New file.
	* eog-image-viewer.oafinfo: New file.
	* main.c: New file.

